{"remainingRequest":"F:\\文档\\丹阳不良债权项目\\丹阳债权清收系统\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\文档\\丹阳不良债权项目\\丹阳债权清收系统\\src\\views\\creditInfo\\creditFinfo\\xqRecall.vue?vue&type=style&index=0&id=e8500008&scoped=true&lang=css&","dependencies":[{"path":"F:\\文档\\丹阳不良债权项目\\丹阳债权清收系统\\src\\views\\creditInfo\\creditFinfo\\xqRecall.vue","mtime":1615968735035},{"path":"F:\\文档\\丹阳不良债权项目\\丹阳债权清收系统\\node_modules\\css-loader\\dist\\cjs.js","mtime":1614934889000},{"path":"F:\\文档\\丹阳不良债权项目\\丹阳债权清收系统\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\文档\\丹阳不良债权项目\\丹阳债权清收系统\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"F:\\文档\\丹阳不良债权项目\\丹阳债权清收系统\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1614934889000},{"path":"F:\\文档\\丹阳不良债权项目\\丹阳债权清收系统\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5lbC1pY29uLXMtaG9tZXsKICBmb250LXNpemU6IDIwMCU7Cn0KLmVsLWJyZWFkY3J1bWIxewogIGZvbnQtc2l6ZTogMTVweDsKICBtYXJnaW4tdG9wOiAxMHB4Owp9Ci5lbC1yb3cxewogIG1hcmdpbi10b3A6IDIwcHg7CiAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgLjEyKSwgMCAwIDZweCByZ2JhKDAsIDAsIDAsIC4wNCk7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIHRleHQtYWxpZ246IGVuZDsKICBoZWlnaHQ6IDUwcHg7CiAgbGluZS1oZWlnaHQ6IDUwcHg7CiAgcGFkZGluZy1yaWdodDogMjBweDsKfQouZWwtcm93MiB7CiAgbWFyZ2luLXRvcDogMzBweDsKICB0ZXh0LWFsaWduOiBlbmQ7CiAgaGVpZ2h0OiA0MHB4OwogIGxpbmUtaGVpZ2h0OiA0MHB4Owp9Ci5lbC1yb3czLCAuZWwtcm93NHsKICBtYXJnaW4tdG9wOiAxMHB4OwogIHRleHQtYWxpZ246IGVuZDsKICBoZWlnaHQ6IDQwcHg7CiAgbGluZS1oZWlnaHQ6IDQwcHg7Cn0KLmdyaWQtY29udGVudDF7CiAgYmFja2dyb3VuZC1jb2xvcjogI0RDREZFNjsKfQouZWwtdGFibGV7CiAgbWFyZ2luLXRvcDogMjBweDsKfQo="},{"version":3,"sources":["xqRecall.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"xqRecall.vue","sourceRoot":"src/views/creditInfo/creditFinfo","sourcesContent":["<template>\n  <div>\n    <el-breadcrumb separator=\"/\">\n      <el-breadcrumb-item to=\"/Main\"><i class=\"el-icon-s-home\"></i></el-breadcrumb-item>\n      <el-breadcrumb-item class=\"el-breadcrumb1\">债权信息</el-breadcrumb-item>\n      <el-breadcrumb-item class=\"el-breadcrumb1\">债权基础信息</el-breadcrumb-item>\n    </el-breadcrumb>\n    <el-row class=\"el-row1\">\n      <el-col :span=\"24\">\n        <div class=\"grid-content\">\n          <el-button @click=\"addRecall\" type=\"primary\">新增</el-button>\n        </div>\n      </el-col>\n    </el-row>\n    <el-menu\n        :default-active=\"activeIndex\"\n        class=\"el-menu-demo\"\n        mode=\"horizontal\"\n        background-color=\"#b2bec3\"\n        text-color=\"#333\"\n        active-text-color=\"#409eff\">\n      <el-menu-item index=\"1\">\n        <router-link\n            :to=\"{path:'/creditInfo/creditFinfo/xqCreditFinfo',query:{iou:query_iou}}\">债权基本信息</router-link>\n      </el-menu-item>\n      <el-menu-item index=\"2\">\n        <router-link\n            :to=\"{path:'/creditInfo/creditFinfo/xqSmortgage',query:{iou:query_iou}}\">担保抵押信息</router-link>\n      </el-menu-item>\n      <el-menu-item index=\"3\">\n        <router-link\n            :to=\"{path:'/creditInfo/creditFinfo/xqFee',query:{iou:query_iou}}\">债权费用信息</router-link>\n      </el-menu-item>\n      <el-menu-item index=\"4\">\n        <router-link\n            :to=\"{path:'/creditInfo/creditFinfo/xqRecall',query:{iou:query_iou}}\">债权清收信息</router-link>\n      </el-menu-item>\n      <el-menu-item index=\"5\">\n        <router-link\n            :to=\"{path:'/creditInfo/creditFinfo/xqJudicature',query:{iou:query_iou}}\">债权司法信息</router-link>\n      </el-menu-item>\n      <el-menu-item index=\"6\">\n        <router-link\n            :to=\"{path:'/creditInfo/creditFinfo/xqCollection',query:{iou:query_iou}}\">债权催收信息</router-link>\n      </el-menu-item>\n    </el-menu>\n\n    <el-form :model=\"form\">\n      <el-form-item>\n        <el-row class=\"el-row2\">\n          <el-col :span=\"2\"><div class=\"grid-content1\">借据号：</div></el-col>\n          <el-col :span=\"7\"><div class=\"grid-content2\"><el-input v-model=\"form.id\" :disabled=\"true\"></el-input></div></el-col>\n          <el-col :span=\"2\"><div class=\"grid-content1\" style=\"margin-left: 20px\">债务人：</div></el-col>\n          <el-col :span=\"7\"><div class=\"grid-content2\"><el-input v-model=\"form.obligor\" :disabled=\"true\"></el-input></div></el-col>\n        </el-row>\n      </el-form-item>\n      <el-form-item>\n        <el-row class=\"el-row3\">\n          <el-col :span=\"2\"><div class=\"grid-content1\">本金：</div></el-col>\n          <el-col :span=\"7\"><div class=\"grid-content2\"><el-input v-model=\"form.principalOfLoan\" :disabled=\"true\"></el-input></div></el-col>\n          <el-col :span=\"2\"><div class=\"grid-content1\" style=\"margin-left: 20px\">利息：</div></el-col>\n          <el-col :span=\"7\"><div class=\"grid-content2\"><el-input v-model=\"form.loanInterest\" :disabled=\"true\"></el-input></div></el-col>\n        </el-row>\n      </el-form-item>\n      <el-form-item>\n        <el-row class=\"el-row4\">\n          <el-col :span=\"2\"><div class=\"grid-content1\">债权人：</div></el-col>\n          <el-col :span=\"7\"><div class=\"grid-content3\" style=\"text-align: start\">\n            <el-select v-model=\"form.creditor\" clearable filterable placeholder=\"请选择\" :disabled=\"true\">\n              <el-option\n                  v-for=\"item in options\"\n                  :key=\"item.value\"\n                  :label=\"item.label\"\n                  :value=\"item.value\">\n              </el-option>\n            </el-select>\n          </div></el-col>\n          <el-col :span=\"2\"><div class=\"grid-content1\" style=\"margin-left: 20px\">备注：</div></el-col>\n          <el-col :span=\"7\"><div class=\"grid-content2\"><el-input v-model=\"form.remarks\" :disabled=\"true\"></el-input></div></el-col>\n        </el-row>\n      </el-form-item>\n      <el-divider></el-divider>\n      <span style=\"font-family: 黑体; font-weight: bold;font-size: 20px\">还款明细</span>\n      <el-table :data=\"tableData\" :summary-method=\"getSummaries\" show-summary>\n        <!--        <el-table-column property=\"id\" label=\"还款ID\" width=\"100\"></el-table-column>-->\n        <el-table-column property=\"repaymentDate\" label=\"还款时间\" width=\"120\">\n          <template slot-scope=\"scope\">\n            <span v-show=\"!scope.row.edit\">{{scope.row.repaymentDate}}</span>\n            <el-date-picker v-show=\"scope.row.edit\" v-model=\"scope.row.repaymentDate\" type=\"date\" placeholder=\"选择日期\" format=\"yyyy-MM-dd\" value-format=\"yyyy-MM-dd\"></el-date-picker>\n          </template>\n        </el-table-column>\n        <el-table-column property=\"repaymentPrincipal\" label=\"还款本金金额\" width=\"120\">\n          <template slot-scope=\"scope\">\n            <span v-show=\"!scope.row.edit\">{{scope.row.repaymentPrincipal}}</span>\n            <el-input size=\"mini\" v-show=\"scope.row.edit\" v-model=\"scope.row.repaymentPrincipal\"></el-input>\n          </template>\n        </el-table-column>\n        <el-table-column property=\"repaymentInterest\" label=\"还款利息金额\" width=\"120\">\n          <template slot-scope=\"scope\">\n            <span v-show=\"!scope.row.edit\">{{scope.row.repaymentInterest}}</span>\n            <el-input size=\"mini\" v-show=\"scope.row.edit\" v-model=\"scope.row.repaymentInterest\"></el-input>\n          </template>\n        </el-table-column>\n        <el-table-column property=\"payType\" label=\"支付方式\" width=\"120\">\n          <template slot-scope=\"scope\">\n            <span v-show=\"!scope.row.edit\">{{scope.row.payType}}</span>\n            <el-input size=\"mini\" v-show=\"scope.row.edit\" v-model=\"scope.row.payType\"></el-input>\n          </template>\n        </el-table-column>\n        <el-table-column property=\"drawee\" label=\"付款人\" width=\"180\">\n          <template slot-scope=\"scope\">\n            <span v-show=\"!scope.row.edit\">{{scope.row.drawee}}</span>\n            <el-input size=\"mini\" v-show=\"scope.row.edit\" v-model=\"scope.row.drawee\"></el-input>\n          </template>\n        </el-table-column>\n        <el-table-column property=\"payee\" label=\"收款人\" width=\"130\">\n          <template slot-scope=\"scope\">\n            <span v-show=\"!scope.row.edit\">{{scope.row.payee}}</span>\n            <el-input size=\"mini\" v-show=\"scope.row.edit\" v-model=\"scope.row.payee\"></el-input>\n          </template>\n        </el-table-column>\n        <el-table-column property=\"remarks\" label=\"备注\" width=\"130\">\n          <template slot-scope=\"scope\">\n            <span v-show=\"!scope.row.edit\">{{scope.row.remarks}}</span>\n            <el-input size=\"mini\" v-show=\"scope.row.edit\" v-model=\"scope.row.remarks\"></el-input>\n          </template>\n        </el-table-column>\n        <el-table-column property=\"operate\" width=\"130\">\n          <template slot=\"header\" slot-scope=\"scope\">\n            <span v-if=\"!edit_state\">操作</span>\n            <el-button type=\"primary\" v-if=\"edit_state\" @click=\"updateSubmit\">提交</el-button>\n          </template>\n          <template slot-scope=\"scope\">\n            <el-button type=\"text\" size=\"small\" @click=\"recallEdit(scope.row, scope.$index)\">{{scope.row.edit_label}}</el-button>\n            <el-button type=\"text\" size=\"small\" @click=\"deleteRecall(scope.row)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      <el-dialog title=\"新增还款记录\" :visible.sync=\"dialogShow\" :append-to-body=\"true\" :close-on-click-modal=\"false\" :before-close=\"handleClose\">\n        <el-form style=\"margin-top: 20px\" ref=\"form1\" :model=\"form_add\" label-width=\"110px\">\n          <el-row :gutter=\"20\">\n            <el-col :span=\"10\" :offset=\"1\">\n              <el-form-item label='还款本金金额：'>\n                <el-input v-model=\"form_add.repaymentPrincipal\" clearable></el-input>\n              </el-form-item>\n            </el-col>\n\n            <el-col :span=\"10\">\n              <el-form-item label='还款利息金额：' class=\"form_item\">\n                <el-input v-model=\"form_add.repaymentInterest\" clearable></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row :gutter=\"20\">\n            <el-col :span=\"10\" :offset=\"1\">\n              <el-form-item label='还款时间：'>\n                <el-date-picker v-model=\"form_add.repaymentDate\" type=\"date\" placeholder=\"选择日期\" style=\"width: 100%\" format=\"yyyy-MM-dd\" value-format=\"yyyy-MM-dd\"></el-date-picker>\n              </el-form-item>\n            </el-col>\n            <el-col :span=\"10\">\n              <el-form-item label=\"支付方式：\">\n                <el-input v-model=\"form_add.payType\" clearable></el-input>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row :gutter=\"20\">\n            <el-col :span=\"10\" :offset=\"1\">\n              <el-form-item label=\"付款人：\">\n                <el-input v-model=\"form_add.drawee\" clearable></el-input>\n              </el-form-item>\n            </el-col>\n\n            <el-col :span=\"10\">\n              <el-form-item label=\"收款人：\">\n                <el-select v-model=\"form_add.payee\" clearable filterable placeholder=\"请选择\" style=\"width: 100%\">\n                  <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"></el-option>\n                </el-select>\n              </el-form-item>\n            </el-col>\n          </el-row>\n        </el-form>\n        <el-button type=\"primary\" @click=\"submitNewRecall\" style=\"margin-left: 50px\">提交</el-button>\n      </el-dialog>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport {default as api} from \"@/utils/api\";\n\nexport default {\n  name: \"xqRecall\",\n  data(){\n    return{\n      activeIndex: '4',\n      form:{},\n      form_add:{iouId:'',repaymentPrincipal:'', repaymentInterest:'', payType:'', drawee:'', payee:'', remarks:''},\n      options: [\n        {value: '天惠投资', label: '天惠投资'},\n        {value: '天晟投资', label: '天晟投资'},\n        {value: '天工惠农小贷', label: '天工惠农小贷'},\n        {value: '银润小贷', label: '银润小贷'},\n        {value: '阳光企业', label: '阳光企业'}],\n      tableData: [],\n      query_iou:this.$route.query.iou,\n      origin_data:'',\n      dialogShow:false,\n      edit_state:false,\n    }\n  },\n  created() {\n    api({\n      url: \"/Recall/getRecall\",\n      method: \"get\",\n      params:{\n        iouId:this.$route.query.iou,\n      }\n    }).then(data => {\n      console.log(data);\n      this.origin_data = data.data.datas;\n      this.jsdata2form(data.data.datas);\n      this.setTableData();\n    }).catch(err => {\n      console.log(err);\n    })\n\n  },\n  methods:{\n    jsdata2form(data){\n      this.form = JSON.parse(JSON.stringify(data));\n    },\n    setTableData(){\n      this.tableData = []\n      for(let i=0;i<this.form.feeList.length;i++){\n        let temp = {};\n        for(let key in this.form.feeList[i]){\n          temp[key] = this.form.feeList[i][key]\n        }\n        temp['edit'] = false;\n        temp['edit_label'] = \"编辑\"\n        this.tableData.push(temp);\n      }\n    },\n    recallEdit(row,index){\n      if(!row.edit){\n        row.edit=true;\n        row.edit_label = \"放弃修改\";\n      }\n      else{\n        row.edit = false;\n        row.edit_label=\"编辑\";\n        row.repaymentDate = this.origin_data.feeList[index].repaymentDate;\n        row.repaymentPrincipal = this.origin_data.feeList[index].repaymentPrincipal;\n        row.repaymentInterest = this.origin_data.feeList[index].repaymentInterest;\n        row.payType = this.origin_data.feeList[index].payType;\n        row.drawee = this.origin_data.feeList[index].drawee;\n        row.payee = this.origin_data.feeList[index].payee;\n        row.remarks = this.origin_data.feeList[index].remarks;\n      }\n      //每一次点击都判断以下所有列的修改状态，更改edit_state\n      this.edit_state = false;\n      this.tableData.forEach((data) => {\n        if(data.edit){\n          this.edit_state = true;\n          return;\n        }\n      })\n      console.log(this.edit_state)\n    },\n    deleteRecall(row){\n      this.$confirm('确认删除？')\n          .then(_ => {\n            api({\n              url: \"/Recall/deleteRecall\",\n              method: \"post\",\n              data:[row.id]\n            }).then(data => {\n              location.reload();\n            }).catch(err => {\n              console.log(err);\n            })\n          })\n          .catch(_ => {});\n    },\n    updateSubmit(){\n      let send_data = [];\n      this.tableData.forEach((data,index) => {\n        if(data.edit){\n          let isChange = false;\n          let temp_data ={};\n          for(let prop in data){\n            if(prop!=='edit' && prop!=='edit_label'){\n              temp_data[prop] = data[prop];\n            }\n            if(data[prop] !== this.origin_data.feeList[index][prop] && prop!=='edit' && prop!=='edit_label'){\n              isChange = true;\n            }\n          }\n          if(isChange){\n            send_data.push(temp_data)\n          }\n        }\n      })\n      if(send_data.length === 0){\n        alert(\"未发现内容变动\");\n      }\n      else{\n        this.$confirm('确认提交？')\n            .then(_ => {\n              api({\n                url: \"/Recall/updateRecall\",\n                method: \"post\",\n                data:send_data\n              }).then(data => {\n                location.reload();\n              }).catch(err => {\n                console.log(err);\n              })\n            })\n            .catch(_ => {});\n      }\n    },\n    getSummaries(param) {\n      const { columns, data } = param;\n      const sums = [];\n      columns.forEach((column, index) => {\n        if (index === 0) {\n          sums[index] = '还款合计';\n          return;\n        }\n        if(index === 1 || index === 2){\n          const values = data.map(item => Number(item[column.property]));\n          if (!values.every(value => isNaN(value))) {\n            sums[index] = values.reduce((prev, curr) => {\n              const value = Number(curr);\n              if (!isNaN(value)) {\n                return prev + curr;\n              } else {\n                return prev;\n              }\n            }, 0);\n            // sums[index] += '';\n          } else {\n            sums[index] = 'N/A';\n          }\n        }\n      });\n      return sums;\n    },\n    handleClose(done){\n      //判断内容为空\n      let isAllNull = true;\n      for(let key in this.form_add){\n        if(this.form_add[key]!=='' && key!=='iouId'){\n          isAllNull = false;\n        }\n      }\n      if(isAllNull){\n        done();\n      }\n      else{\n        this.$confirm('确认关闭并放弃修改？')\n            .then(_ => {\n              this.form_add = {iouId:this.form.id,repaymentPrincipal:'', repaymentInterest:'', payType:'', drawee:'', payee:'', remarks:''},\n                  done();\n            })\n            .catch(_ => {});\n      }\n\n    },\n    addRecall(){\n      this.dialogShow = true;\n      //为form_add赋值\n      this.form_add.iouId = this.form.id;\n    },\n    submitNewRecall(){\n      //判断内容为空\n      let isAllNull = true;\n      for(let key in this.form_add){\n        if(this.form_add[key]!=='' && key!=='iouId'){\n          isAllNull = false;\n        }\n      }\n      if(isAllNull){\n        alert(\"内容为空\");\n      }\n      else{\n        this.$confirm('确认提交？')\n            .then(_ => {\n              api({\n                url: \"/Recall/addRecall\",\n                method: \"post\",\n                data:this.form_add\n              }).then(data => {\n                location.reload();\n              }).catch(err => {\n                console.log(err);\n              })\n            })\n            .catch(_ => {});\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.el-icon-s-home{\n  font-size: 200%;\n}\n.el-breadcrumb1{\n  font-size: 15px;\n  margin-top: 10px;\n}\n.el-row1{\n  margin-top: 20px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04);\n  border-radius: 4px;\n  text-align: end;\n  height: 50px;\n  line-height: 50px;\n  padding-right: 20px;\n}\n.el-row2 {\n  margin-top: 30px;\n  text-align: end;\n  height: 40px;\n  line-height: 40px;\n}\n.el-row3, .el-row4{\n  margin-top: 10px;\n  text-align: end;\n  height: 40px;\n  line-height: 40px;\n}\n.grid-content1{\n  background-color: #DCDFE6;\n}\n.el-table{\n  margin-top: 20px;\n}\n</style>\n"]}]}